{"ast":null,"code":"var _jsxFileName = \"/Users/usedcvnt/Documents/IDEProjects/VSCProjects/1st/frontend/src/pages/vacations/VacationForm.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react'; // Убран useCallback и flushSync\nimport { motion, AnimatePresence } from 'framer-motion';\nimport DatePicker, { registerLocale } from 'react-datepicker';\nimport { toast } from 'react-toastify';\nimport { FaCalendarAlt, FaPlus, FaTrash, FaSave, FaPaperPlane } from 'react-icons/fa';\nimport ru from 'date-fns/locale/ru';\nimport { getVacationLimit, createVacationRequest, submitVacationRequest } from '../../api/vacations'; // Предполагается, что API файл будет создан\nimport 'react-datepicker/dist/react-datepicker.css';\nimport './VacationForm.css';\n\n// Регистрация русской локали для DatePicker\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nregisterLocale('ru', ru);\nconst VacationForm = () => {\n  _s();\n  const [year, setYear] = useState(new Date().getFullYear() + 1);\n  const [periods, setPeriods] = useState([{\n    startDate: null,\n    endDate: null,\n    daysCount: 0\n  }]);\n  const [status, setStatus] = useState('draft'); // 'draft', 'submitted'\n  const [limit, setLimit] = useState(28);\n  const [usedDays, setUsedDays] = useState(0);\n  const [loading, setLoading] = useState(false); // Для загрузки лимита\n  const [submitting, setSubmitting] = useState(false); // Для сохранения/отправки\n  const [errors, setErrors] = useState({});\n  const [requestId, setRequestId] = useState(null); // ID сохраненной заявки\n\n  // Загрузка лимита отпуска при изменении года\n  useEffect(() => {\n    const fetchLimit = async () => {\n      try {\n        setLoading(true);\n        const limitData = await getVacationLimit(year); // Используем реальный API вызов\n        setLimit(limitData.total_days);\n        setUsedDays(limitData.used_days);\n      } catch (error) {\n        // Обработка ошибки, если лимит не найден (например, для нового пользователя/года)\n        if (error.message.includes(\"лимит отпуска не найден\")) {\n          toast.info(`Лимит на ${year} год еще не установлен. Используется стандартный лимит (${limit} дней).`);\n          // Оставляем дефолтные значения limit и usedDays\n        } else {\n          toast.error(\"Ошибка при загрузке лимита отпуска\"); // Показываем общую ошибку, если это не ошибка \"лимит не найден\"\n        }\n        // toast.error(\"Ошибка при загрузке лимита отпуска\"); // Убираем дублирующийся вызов\n        console.error(\"Ошибка при загрузке лимита:\", error); // Логируем ошибку для отладки\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchLimit();\n  }, [year]);\n\n  // Вычисление общего количества дней\n  const totalDaysRequested = periods.reduce((sum, period) => sum + period.daysCount, 0);\n  const remainingDays = limit - usedDays - totalDaysRequested;\n\n  // Функция для подсчета дней между датами\n  const calculateDays = (startDate, endDate) => {\n    if (!startDate || !endDate || startDate > endDate) return 0; // Добавлена проверка startDate > endDate\n    const diffTime = Math.abs(endDate.getTime() - startDate.getTime());\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;\n  };\n\n  // Обработка изменения года\n  const handleYearChange = e => {\n    setYear(parseInt(e.target.value));\n    // Сброс периодов и ошибок при смене года\n    setPeriods([{\n      startDate: null,\n      endDate: null,\n      daysCount: 0\n    }]);\n    setErrors({});\n    setRequestId(null);\n    setStatus('draft');\n  };\n\n  // Обработка изменения дат\n  const handleDateChange = (index, field, date) => {\n    const newPeriods = [...periods];\n    newPeriods[index][field] = date;\n\n    // Автоматический расчет дней, если обе даты выбраны и start <= end\n    if (newPeriods[index].startDate && newPeriods[index].endDate && newPeriods[index].startDate <= newPeriods[index].endDate) {\n      newPeriods[index].daysCount = calculateDays(newPeriods[index].startDate, newPeriods[index].endDate);\n    } else {\n      newPeriods[index].daysCount = 0; // Сброс, если даты некорректны\n    }\n    setPeriods(newPeriods);\n    validateForm(newPeriods); // Валидация при каждом изменении\n  };\n\n  // Добавление нового периода\n  const addPeriod = () => {\n    setPeriods([...periods, {\n      startDate: null,\n      endDate: null,\n      daysCount: 0\n    }]);\n  };\n\n  // Удаление периода\n  const removePeriod = index => {\n    const newPeriods = periods.filter((_, i) => i !== index);\n    setPeriods(newPeriods);\n    validateForm(newPeriods); // Валидация после удаления\n  };\n\n  // Валидация формы (переработанная логика)\n  // Убран useCallback\n  const validateForm = (periodsToValidate = periods) => {\n    // Снова принимаем аргумент или используем состояние\n    // Всегда начинаем с пустого объекта ошибок\n    const currentErrors = {};\n    // const periodsToValidate = periods; // Используем переданный аргумент или состояние\n\n    // 1. Проверка базовой корректности дат и наличия периодов\n    if (periodsToValidate.length === 0) {\n      currentErrors.noPeriods = 'Необходимо добавить хотя бы один период отпуска.';\n      // Устанавливаем ошибки и выходим, если периодов нет\n      setErrors(currentErrors);\n      return false;\n    }\n    const hasInvalidDates = periodsToValidate.some(period => !period.startDate || !period.endDate || period.startDate > period.endDate);\n    if (hasInvalidDates) {\n      currentErrors.invalidDates = 'Все даты должны быть заполнены корректно (дата начала <= дата окончания).';\n      // Не выходим сразу, чтобы проверить и другие ошибки, если возможно\n    }\n\n    // 2. Проверка общих дней и правила 14 дней (только если базовые даты корректны)\n    if (!hasInvalidDates) {\n      const totalRequested = periodsToValidate.reduce((sum, period) => sum + period.daysCount, 0);\n      if (totalRequested <= 0) {\n        currentErrors.noDays = 'Необходимо запросить хотя бы один день отпуска (проверьте даты).';\n      } else {\n        // totalRequested > 0\n        // Отладка: выводим периоды и рассчитанные дни\n        console.log('Validating 14-day rule. Periods:', JSON.stringify(periodsToValidate.map(p => ({\n          start: p.startDate,\n          end: p.endDate,\n          days: p.daysCount\n        }))));\n\n        // Проверяем правило 14 дней\n        const hasLongPeriod = periodsToValidate.some(period => period.daysCount >= 14);\n        console.log('Has long period (>= 14 days):', hasLongPeriod); // Отладка\n        // Добавляем ошибку только если условие НЕ выполнено\n        if (!hasLongPeriod) {\n          currentErrors.longPeriod = 'Одна из частей отпуска должна быть не менее 14 календарных дней.';\n        }\n        // Проверяем лимит\n        if (totalRequested > limit - usedDays) {\n          currentErrors.limit = `Превышен доступный лимит дней отпуска (${limit - usedDays} дн.).`;\n        }\n      }\n    }\n\n    // Log the errors object *before* setting state\n    console.log(\"Errors object calculated:\", JSON.stringify(currentErrors));\n\n    // Простое обновление состояния\n    setErrors({\n      ...currentErrors\n    });\n\n    // Log *after* setting state (хотя это может не показать обновленное значение немедленно)\n    // console.log(\"Called setErrors with:\", JSON.stringify(currentErrors)); // Можно убрать этот лог\n\n    const isValid = Object.keys(currentErrors).length === 0;\n    console.log(`validateForm returning: ${isValid}`); // Log the return value\n    return isValid; // Проверяем собранный объект\n  };\n\n  // Убран useEffect для валидации\n\n  // Отправка заявки руководителю (объединяет сохранение и отправку)\n  const handleSubmit = async e => {\n    // Предотвращаем стандартное поведение формы, если вызвано через onSubmit\n    if (e && typeof e.preventDefault === 'function') {\n      e.preventDefault();\n    }\n\n    // Вызываем validateForm() непосредственно перед отправкой для актуальной проверки\n    if (!validateForm()) {\n      console.log(\"Submit blocked by validateForm() check.\");\n      toast.warn('Пожалуйста, исправьте ошибки в форме перед отправкой');\n      return;\n    }\n    console.log(\"Validation passed in handleSubmit, proceeding.\");\n    setSubmitting(true);\n    try {\n      let currentRequestId = requestId;\n\n      // 1. Создаем/обновляем черновик, если необходимо\n      // (Предполагаем, что API createVacationRequest может обрабатывать обновление,\n      // или всегда создает новую запись, что тоже приемлемо для упрощения)\n      const vacationRequest = {\n        year,\n        periods: periods.map(period => ({\n          // Отправляем дату в полном формате ISO 8601 (RFC3339), который Go понимает по умолчанию\n          // Ключи должны соответствовать JSON-тегам в Go модели (snake_case)\n          start_date: period.startDate.toISOString(),\n          end_date: period.endDate.toISOString(),\n          days_count: period.daysCount\n        })),\n        statusId: 1 // Черновик (или статус для отправки, если API требует)\n      };\n\n      // Всегда вызываем create, чтобы получить актуальный ID перед отправкой\n      // (или используем update, если API позволяет и requestId есть)\n      const createResponse = await createVacationRequest(vacationRequest);\n      currentRequestId = createResponse.id; // Получаем ID созданной/обновленной заявки\n      setRequestId(currentRequestId); // Обновляем состояние ID\n      toast.info('Черновик сохранен/обновлен.'); // Информируем пользователя\n\n      // 2. Отправляем заявку с полученным ID\n      await submitVacationRequest(currentRequestId);\n      toast.success('Заявка успешно отправлена руководителю');\n      setStatus('submitted'); // Меняем статус в UI\n    } catch (error) {\n      toast.error(error.message || 'Ошибка при сохранении или отправке заявки');\n      // Не сбрасываем submitting в случае ошибки, чтобы пользователь мог попробовать еще раз?\n      // Или сбрасываем, чтобы кнопка стала активной? Решаем сбросить.\n      // setSubmitting(false); // Убираем сброс из catch, он будет в finally\n    } finally {\n      // Блок finally выполняется всегда, поэтому просто сбрасываем submitting здесь\n      setSubmitting(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    className: \"vacation-form-container\",\n    initial: {\n      opacity: 0\n    },\n    animate: {\n      opacity: 1\n    },\n    transition: {\n      duration: 0.5\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"\\u041E\\u0444\\u043E\\u0440\\u043C\\u043B\\u0435\\u043D\\u0438\\u0435 \\u043E\\u0442\\u043F\\u0443\\u0441\\u043A\\u0430 \\u043D\\u0430 \", year, \" \\u0433\\u043E\\u0434\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"year-selector\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"year\",\n        children: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0433\\u043E\\u0434:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"year\",\n        value: year,\n        onChange: handleYearChange,\n        disabled: loading || submitting,\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: new Date().getFullYear(),\n          children: \"\\u0422\\u0435\\u043A\\u0443\\u0449\\u0438\\u0439 \\u0433\\u043E\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n          value: new Date().getFullYear() + 1,\n          children: \"\\u0421\\u043B\\u0435\\u0434\\u0443\\u044E\\u0449\\u0438\\u0439 \\u0433\\u043E\\u0434\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"loading-indicator\",\n        children: \" \\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043B\\u0438\\u043C\\u0438\\u0442\\u0430...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(motion.div, {\n      className: \"vacation-limits card\" // Добавлен класс card\n      ,\n      initial: {\n        x: -20,\n        opacity: 0\n      },\n      animate: {\n        x: 0,\n        opacity: 1\n      },\n      transition: {\n        delay: 0.2\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"limit-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u0414\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u043E \\u0434\\u043D\\u0435\\u0439:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"limit-value\",\n          children: limit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"limit-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u0418\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u043D\\u043E:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"limit-value\",\n          children: usedDays\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"limit-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u0417\\u0430\\u043F\\u0440\\u043E\\u0448\\u0435\\u043D\\u043E:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"limit-value\",\n          children: totalDaysRequested\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"limit-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u041E\\u0441\\u0442\\u0430\\u043B\\u043E\\u0441\\u044C:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: `limit-value ${remainingDays < 0 ? 'error' : ''}`,\n          children: remainingDays\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 7\n    }, this), errors.invalidDates && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: errors.invalidDates\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 31\n    }, this), errors.noPeriods && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: errors.noPeriods\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 28\n    }, this), errors.noDays && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: errors.noDays\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 25\n    }, this), errors.longPeriod ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: errors.longPeriod\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 28\n    }, this) : null, errors.limit && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"error-message\",\n      children: errors.limit\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 24\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [\" \", periods.map((period, index) => /*#__PURE__*/_jsxDEV(motion.div, {\n        className: \"vacation-period card\" // Добавлен класс card\n        ,\n        initial: {\n          opacity: 0,\n          y: 20\n        },\n        animate: {\n          opacity: 1,\n          y: 0\n        },\n        exit: {\n          opacity: 0,\n          y: -20\n        },\n        transition: {\n          delay: index * 0.1\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"\\u0427\\u0430\\u0441\\u0442\\u044C \\u043E\\u0442\\u043F\\u0443\\u0441\\u043A\\u0430 \", index + 1]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"date-inputs\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"date-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: `start-date-${index}`,\n              children: \"\\u0414\\u0430\\u0442\\u0430 \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"date-picker-container\",\n              children: [/*#__PURE__*/_jsxDEV(DatePicker, {\n                id: `start-date-${index}`,\n                selected: period.startDate,\n                onChange: date => handleDateChange(index, 'startDate', date),\n                selectsStart: true,\n                startDate: period.startDate,\n                endDate: period.endDate,\n                minDate: new Date(year, 0, 1),\n                maxDate: new Date(year, 11, 31),\n                dateFormat: \"dd.MM.yyyy\",\n                locale: \"ru\",\n                placeholderText: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0430\\u0442\\u0443\",\n                className: \"date-input\",\n                disabled: submitting || status === 'submitted'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(FaCalendarAlt, {\n                className: \"date-icon\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 310,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 294,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"date-field\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: `end-date-${index}`,\n              children: \"\\u0414\\u0430\\u0442\\u0430 \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"date-picker-container\",\n              children: [/*#__PURE__*/_jsxDEV(DatePicker, {\n                id: `end-date-${index}`,\n                selected: period.endDate,\n                onChange: date => handleDateChange(index, 'endDate', date),\n                selectsEnd: true,\n                startDate: period.startDate,\n                endDate: period.endDate,\n                minDate: period.startDate || new Date(year, 0, 1),\n                maxDate: new Date(year, 11, 31),\n                dateFormat: \"dd.MM.yyyy\",\n                locale: \"ru\",\n                placeholderText: \"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u0434\\u0430\\u0442\\u0443\",\n                className: \"date-input\",\n                disabled: submitting || status === 'submitted' || !period.startDate // Блокируем, пока не выбрана дата начала\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 317,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(FaCalendarAlt, {\n                className: \"date-icon\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 332,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"days-count\",\n          children: [\"\\u041A\\u043E\\u043B\\u0438\\u0447\\u0435\\u0441\\u0442\\u0432\\u043E \\u0434\\u043D\\u0435\\u0439: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: period.daysCount\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 34\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 15\n        }, this), periods.length > 1 && /*#__PURE__*/_jsxDEV(motion.button, {\n          type: \"button\",\n          className: \"remove-period btn btn-danger\" // Добавлены классы btn\n          ,\n          onClick: () => removePeriod(index),\n          whileHover: {\n            scale: 1.05\n          },\n          whileTap: {\n            scale: 0.95\n          },\n          disabled: submitting || status === 'submitted',\n          children: [/*#__PURE__*/_jsxDEV(FaTrash, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 19\n          }, this), \" \\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u0447\\u0430\\u0441\\u0442\\u044C\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 17\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 13\n      }, this)), \" \", /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-actions\",\n        children: [/*#__PURE__*/_jsxDEV(motion.button, {\n          type: \"button\",\n          className: \"add-period btn\" // Добавлен класс btn\n          ,\n          onClick: addPeriod,\n          whileHover: {\n            scale: 1.05\n          },\n          whileTap: {\n            scale: 0.95\n          },\n          disabled: submitting || status === 'submitted',\n          children: [/*#__PURE__*/_jsxDEV(FaPlus, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 13\n          }, this), \" \\u0414\\u043E\\u0431\\u0430\\u0432\\u0438\\u0442\\u044C \\u0447\\u0430\\u0441\\u0442\\u044C \\u043E\\u0442\\u043F\\u0443\\u0441\\u043A\\u0430\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(motion.button, {\n          type: \"submit\" // Изменен тип на submit\n          ,\n          className: \"submit-request btn btn-success\" // Оставляем классы\n          ,\n          whileHover: {\n            scale: 1.05\n          },\n          whileTap: {\n            scale: 0.95\n          },\n          disabled: submitting || status === 'submitted' || Object.keys(errors).length > 0 // Блокируем при ошибках валидации\n          ,\n          children: [/*#__PURE__*/_jsxDEV(FaPaperPlane, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 383,\n            columnNumber: 13\n          }, this), \" \\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u0440\\u0443\\u043A\\u043E\\u0432\\u043E\\u0434\\u0438\\u0442\\u0435\\u043B\\u044E\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }, this), status === 'submitted' && /*#__PURE__*/_jsxDEV(motion.div, {\n      className: \"success-message\" // Нужен CSS для этого класса\n      ,\n      initial: {\n        opacity: 0,\n        y: 10\n      },\n      animate: {\n        opacity: 1,\n        y: 0\n      },\n      children: \"\\u0417\\u0430\\u044F\\u0432\\u043A\\u0430 \\u0443\\u0441\\u043F\\u0435\\u0448\\u043D\\u043E \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0430!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 225,\n    columnNumber: 5\n  }, this);\n};\n_s(VacationForm, \"Wq7iAUzeIFGQCPxjxacLuz0NKso=\");\n_c = VacationForm;\nexport default VacationForm;\nvar _c;\n$RefreshReg$(_c, \"VacationForm\");","map":{"version":3,"names":["React","useState","useEffect","motion","AnimatePresence","DatePicker","registerLocale","toast","FaCalendarAlt","FaPlus","FaTrash","FaSave","FaPaperPlane","ru","getVacationLimit","createVacationRequest","submitVacationRequest","jsxDEV","_jsxDEV","VacationForm","_s","year","setYear","Date","getFullYear","periods","setPeriods","startDate","endDate","daysCount","status","setStatus","limit","setLimit","usedDays","setUsedDays","loading","setLoading","submitting","setSubmitting","errors","setErrors","requestId","setRequestId","fetchLimit","limitData","total_days","used_days","error","message","includes","info","console","totalDaysRequested","reduce","sum","period","remainingDays","calculateDays","diffTime","Math","abs","getTime","ceil","handleYearChange","e","parseInt","target","value","handleDateChange","index","field","date","newPeriods","validateForm","addPeriod","removePeriod","filter","_","i","periodsToValidate","currentErrors","length","noPeriods","hasInvalidDates","some","invalidDates","totalRequested","noDays","log","JSON","stringify","map","p","start","end","days","hasLongPeriod","longPeriod","isValid","Object","keys","handleSubmit","preventDefault","warn","currentRequestId","vacationRequest","start_date","toISOString","end_date","days_count","statusId","createResponse","id","success","div","className","initial","opacity","animate","transition","duration","children","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","onChange","disabled","x","delay","onSubmit","y","exit","selected","selectsStart","minDate","maxDate","dateFormat","locale","placeholderText","selectsEnd","button","type","onClick","whileHover","scale","whileTap","_c","$RefreshReg$"],"sources":["/Users/usedcvnt/Documents/IDEProjects/VSCProjects/1st/frontend/src/pages/vacations/VacationForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'; // Убран useCallback и flushSync\nimport { motion, AnimatePresence } from 'framer-motion';\nimport DatePicker, { registerLocale } from 'react-datepicker';\nimport { toast } from 'react-toastify';\nimport { FaCalendarAlt, FaPlus, FaTrash, FaSave, FaPaperPlane } from 'react-icons/fa';\nimport ru from 'date-fns/locale/ru';\nimport { getVacationLimit, createVacationRequest, submitVacationRequest } from '../../api/vacations'; // Предполагается, что API файл будет создан\nimport 'react-datepicker/dist/react-datepicker.css';\nimport './VacationForm.css';\n\n// Регистрация русской локали для DatePicker\nregisterLocale('ru', ru);\n\nconst VacationForm = () => {\n  const [year, setYear] = useState(new Date().getFullYear() + 1);\n  const [periods, setPeriods] = useState([{ startDate: null, endDate: null, daysCount: 0 }]);\n  const [status, setStatus] = useState('draft'); // 'draft', 'submitted'\n  const [limit, setLimit] = useState(28);\n  const [usedDays, setUsedDays] = useState(0);\n  const [loading, setLoading] = useState(false); // Для загрузки лимита\n  const [submitting, setSubmitting] = useState(false); // Для сохранения/отправки\n  const [errors, setErrors] = useState({});\n  const [requestId, setRequestId] = useState(null); // ID сохраненной заявки\n\n\n  // Загрузка лимита отпуска при изменении года\n  useEffect(() => {\n    const fetchLimit = async () => {\n      try {\n        setLoading(true);\n        const limitData = await getVacationLimit(year); // Используем реальный API вызов\n        setLimit(limitData.total_days);\n        setUsedDays(limitData.used_days);\n      } catch (error) {\n        // Обработка ошибки, если лимит не найден (например, для нового пользователя/года)\n        if (error.message.includes(\"лимит отпуска не найден\")) {\n            toast.info(`Лимит на ${year} год еще не установлен. Используется стандартный лимит (${limit} дней).`);\n            // Оставляем дефолтные значения limit и usedDays\n        } else {\n            toast.error(\"Ошибка при загрузке лимита отпуска\"); // Показываем общую ошибку, если это не ошибка \"лимит не найден\"\n        }\n        // toast.error(\"Ошибка при загрузке лимита отпуска\"); // Убираем дублирующийся вызов\n        console.error(\"Ошибка при загрузке лимита:\", error); // Логируем ошибку для отладки\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    fetchLimit();\n  }, [year]);\n\n  // Вычисление общего количества дней\n  const totalDaysRequested = periods.reduce((sum, period) => sum + period.daysCount, 0);\n  const remainingDays = limit - usedDays - totalDaysRequested;\n\n  // Функция для подсчета дней между датами\n  const calculateDays = (startDate, endDate) => {\n    if (!startDate || !endDate || startDate > endDate) return 0; // Добавлена проверка startDate > endDate\n    const diffTime = Math.abs(endDate.getTime() - startDate.getTime());\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;\n  };\n\n  // Обработка изменения года\n  const handleYearChange = (e) => {\n    setYear(parseInt(e.target.value));\n    // Сброс периодов и ошибок при смене года\n    setPeriods([{ startDate: null, endDate: null, daysCount: 0 }]);\n    setErrors({});\n    setRequestId(null);\n    setStatus('draft');\n  };\n\n  // Обработка изменения дат\n  const handleDateChange = (index, field, date) => {\n    const newPeriods = [...periods];\n    newPeriods[index][field] = date;\n    \n    // Автоматический расчет дней, если обе даты выбраны и start <= end\n    if (newPeriods[index].startDate && newPeriods[index].endDate && newPeriods[index].startDate <= newPeriods[index].endDate) {\n      newPeriods[index].daysCount = calculateDays(\n        newPeriods[index].startDate,\n        newPeriods[index].endDate\n      );\n    } else {\n      newPeriods[index].daysCount = 0; // Сброс, если даты некорректны\n    }\n    \n    setPeriods(newPeriods);\n    validateForm(newPeriods); // Валидация при каждом изменении\n  };\n\n  // Добавление нового периода\n  const addPeriod = () => {\n    setPeriods([...periods, { startDate: null, endDate: null, daysCount: 0 }]);\n  };\n\n  // Удаление периода\n  const removePeriod = (index) => {\n    const newPeriods = periods.filter((_, i) => i !== index);\n    setPeriods(newPeriods);\n    validateForm(newPeriods); // Валидация после удаления\n  };\n\n  // Валидация формы (переработанная логика)\n  // Убран useCallback\n  const validateForm = (periodsToValidate = periods) => { // Снова принимаем аргумент или используем состояние\n    // Всегда начинаем с пустого объекта ошибок\n    const currentErrors = {}; \n    // const periodsToValidate = periods; // Используем переданный аргумент или состояние\n\n    // 1. Проверка базовой корректности дат и наличия периодов\n    if (periodsToValidate.length === 0) {\n      currentErrors.noPeriods = 'Необходимо добавить хотя бы один период отпуска.';\n      // Устанавливаем ошибки и выходим, если периодов нет\n      setErrors(currentErrors);\n      return false;\n    }\n\n    const hasInvalidDates = periodsToValidate.some(\n      period => !period.startDate || !period.endDate || period.startDate > period.endDate\n    );\n    if (hasInvalidDates) {\n      currentErrors.invalidDates = 'Все даты должны быть заполнены корректно (дата начала <= дата окончания).';\n      // Не выходим сразу, чтобы проверить и другие ошибки, если возможно\n    }\n\n    // 2. Проверка общих дней и правила 14 дней (только если базовые даты корректны)\n    if (!hasInvalidDates) {\n      const totalRequested = periodsToValidate.reduce((sum, period) => sum + period.daysCount, 0);\n      \n      if (totalRequested <= 0) {\n           currentErrors.noDays = 'Необходимо запросить хотя бы один день отпуска (проверьте даты).';\n      } else { // totalRequested > 0\n          // Отладка: выводим периоды и рассчитанные дни\n          console.log('Validating 14-day rule. Periods:', JSON.stringify(periodsToValidate.map(p => ({ start: p.startDate, end: p.endDate, days: p.daysCount }))));\n          \n          // Проверяем правило 14 дней\n          const hasLongPeriod = periodsToValidate.some(period => period.daysCount >= 14);\n          console.log('Has long period (>= 14 days):', hasLongPeriod); // Отладка\n          // Добавляем ошибку только если условие НЕ выполнено\n          if (!hasLongPeriod) { \n              currentErrors.longPeriod = 'Одна из частей отпуска должна быть не менее 14 календарных дней.';\n          }\n          // Проверяем лимит\n          if (totalRequested > (limit - usedDays)) {\n              currentErrors.limit = `Превышен доступный лимит дней отпуска (${limit - usedDays} дн.).`;\n          }\n      }\n    }\n    \n    // Log the errors object *before* setting state\n    console.log(\"Errors object calculated:\", JSON.stringify(currentErrors));\n    \n    // Простое обновление состояния\n    setErrors({ ...currentErrors }); \n\n    // Log *after* setting state (хотя это может не показать обновленное значение немедленно)\n    // console.log(\"Called setErrors with:\", JSON.stringify(currentErrors)); // Можно убрать этот лог\n    \n    const isValid = Object.keys(currentErrors).length === 0;\n    console.log(`validateForm returning: ${isValid}`); // Log the return value\n    return isValid; // Проверяем собранный объект\n  };\n  \n  // Убран useEffect для валидации\n\n  // Отправка заявки руководителю (объединяет сохранение и отправку)\n  const handleSubmit = async (e) => {\n    // Предотвращаем стандартное поведение формы, если вызвано через onSubmit\n    if (e && typeof e.preventDefault === 'function') {\n        e.preventDefault();\n    }\n\n    // Вызываем validateForm() непосредственно перед отправкой для актуальной проверки\n    if (!validateForm()) {\n        console.log(\"Submit blocked by validateForm() check.\");\n        toast.warn('Пожалуйста, исправьте ошибки в форме перед отправкой');\n        return;\n    }\n\n    console.log(\"Validation passed in handleSubmit, proceeding.\");\n    setSubmitting(true);\n    try {\n      let currentRequestId = requestId;\n\n      // 1. Создаем/обновляем черновик, если необходимо\n      // (Предполагаем, что API createVacationRequest может обрабатывать обновление,\n      // или всегда создает новую запись, что тоже приемлемо для упрощения)\n      const vacationRequest = {\n        year,\n        periods: periods.map(period => ({\n          // Отправляем дату в полном формате ISO 8601 (RFC3339), который Go понимает по умолчанию\n          // Ключи должны соответствовать JSON-тегам в Go модели (snake_case)\n          start_date: period.startDate.toISOString(), \n          end_date: period.endDate.toISOString(),\n          days_count: period.daysCount \n        })),\n        statusId: 1 // Черновик (или статус для отправки, если API требует)\n      };\n\n      // Всегда вызываем create, чтобы получить актуальный ID перед отправкой\n      // (или используем update, если API позволяет и requestId есть)\n      const createResponse = await createVacationRequest(vacationRequest);\n      currentRequestId = createResponse.id; // Получаем ID созданной/обновленной заявки\n      setRequestId(currentRequestId); // Обновляем состояние ID\n      toast.info('Черновик сохранен/обновлен.'); // Информируем пользователя\n\n      // 2. Отправляем заявку с полученным ID\n      await submitVacationRequest(currentRequestId);\n      toast.success('Заявка успешно отправлена руководителю');\n      setStatus('submitted'); // Меняем статус в UI\n\n    } catch (error) {\n      toast.error(error.message || 'Ошибка при сохранении или отправке заявки');\n      // Не сбрасываем submitting в случае ошибки, чтобы пользователь мог попробовать еще раз?\n      // Или сбрасываем, чтобы кнопка стала активной? Решаем сбросить.\n      // setSubmitting(false); // Убираем сброс из catch, он будет в finally\n    } finally {\n      // Блок finally выполняется всегда, поэтому просто сбрасываем submitting здесь\n      setSubmitting(false);\n    }\n  };\n\n  return (\n    <motion.div\n      className=\"vacation-form-container\"\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      transition={{ duration: 0.5 }}\n    >\n      <h2>Оформление отпуска на {year} год</h2>\n      \n      <div className=\"year-selector\">\n        <label htmlFor=\"year\">Выберите год:</label>\n        <select id=\"year\" value={year} onChange={handleYearChange} disabled={loading || submitting}>\n          <option value={new Date().getFullYear()}>Текущий год</option>\n          <option value={new Date().getFullYear() + 1}>Следующий год</option>\n        </select>\n        {loading && <span className=\"loading-indicator\"> Загрузка лимита...</span>}\n      </div>\n      \n      <motion.div \n        className=\"vacation-limits card\" // Добавлен класс card\n        initial={{ x: -20, opacity: 0 }}\n        animate={{ x: 0, opacity: 1 }}\n        transition={{ delay: 0.2 }}\n      >\n        <div className=\"limit-item\">\n          <span>Доступно дней:</span>\n          <span className=\"limit-value\">{limit}</span>\n        </div>\n        <div className=\"limit-item\">\n          <span>Использовано:</span>\n          <span className=\"limit-value\">{usedDays}</span>\n        </div>\n        <div className=\"limit-item\">\n          <span>Запрошено:</span>\n          <span className=\"limit-value\">{totalDaysRequested}</span>\n        </div>\n        <div className=\"limit-item\">\n          <span>Осталось:</span>\n          <span className={`limit-value ${remainingDays < 0 ? 'error' : ''}`}>\n            {remainingDays}\n          </span>\n        </div>\n      </motion.div>\n      \n      {/* Отображение ошибок (изменено на явные проверки) */}\n      {errors.invalidDates && <div className=\"error-message\">{errors.invalidDates}</div>}\n      {errors.noPeriods && <div className=\"error-message\">{errors.noPeriods}</div>}\n      {errors.noDays && <div className=\"error-message\">{errors.noDays}</div>}\n      {/* Упрощенное отображение ошибки без анимации */}\n      {/* Убран console.log из рендера */}\n      {errors.longPeriod ? <div className=\"error-message\">{errors.longPeriod}</div> : null} \n      {errors.limit && <div className=\"error-message\">{errors.limit}</div>}\n      \n      {/* Форма теперь вызывает handleSubmit при отправке */}\n      <form onSubmit={handleSubmit}> \n        {/* <AnimatePresence> */} {/* Временно убираем AnimatePresence */}\n          {periods.map((period, index) => (\n            <motion.div\n              key={index}\n              className=\"vacation-period card\" // Добавлен класс card\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -20 }}\n              transition={{ delay: index * 0.1 }}\n            >\n              <h3>Часть отпуска {index + 1}</h3>\n              \n              <div className=\"date-inputs\">\n                <div className=\"date-field\">\n                  <label htmlFor={`start-date-${index}`}>Дата начала</label>\n                  <div className=\"date-picker-container\">\n                    <DatePicker\n                      id={`start-date-${index}`}\n                      selected={period.startDate}\n                      onChange={(date) => handleDateChange(index, 'startDate', date)}\n                      selectsStart\n                      startDate={period.startDate}\n                      endDate={period.endDate}\n                      minDate={new Date(year, 0, 1)}\n                      maxDate={new Date(year, 11, 31)}\n                      dateFormat=\"dd.MM.yyyy\"\n                      locale=\"ru\"\n                      placeholderText=\"Выберите дату\"\n                      className=\"date-input\"\n                      disabled={submitting || status === 'submitted'}\n                    />\n                    <FaCalendarAlt className=\"date-icon\" />\n                  </div>\n                </div>\n                \n                <div className=\"date-field\">\n                  <label htmlFor={`end-date-${index}`}>Дата окончания</label>\n                  <div className=\"date-picker-container\">\n                    <DatePicker\n                      id={`end-date-${index}`}\n                      selected={period.endDate}\n                      onChange={(date) => handleDateChange(index, 'endDate', date)}\n                      selectsEnd\n                      startDate={period.startDate}\n                      endDate={period.endDate}\n                      minDate={period.startDate || new Date(year, 0, 1)}\n                      maxDate={new Date(year, 11, 31)}\n                      dateFormat=\"dd.MM.yyyy\"\n                      locale=\"ru\"\n                      placeholderText=\"Выберите дату\"\n                      className=\"date-input\"\n                      disabled={submitting || status === 'submitted' || !period.startDate} // Блокируем, пока не выбрана дата начала\n                    />\n                    <FaCalendarAlt className=\"date-icon\" />\n                  </div>\n                </div>\n              </div>\n              \n              <div className=\"days-count\">\n                Количество дней: <strong>{period.daysCount}</strong>\n              </div>\n              \n              {periods.length > 1 && (\n                <motion.button\n                  type=\"button\"\n                  className=\"remove-period btn btn-danger\" // Добавлены классы btn\n                  onClick={() => removePeriod(index)}\n                  whileHover={{ scale: 1.05 }}\n                  whileTap={{ scale: 0.95 }}\n                  disabled={submitting || status === 'submitted'}\n                >\n                  <FaTrash /> Удалить часть\n                </motion.button>\n              )}\n            </motion.div>\n          ))}\n        {/* </AnimatePresence> */} {/* Временно убираем AnimatePresence */}\n        \n        <div className=\"form-actions\">\n          <motion.button\n            type=\"button\"\n            className=\"add-period btn\" // Добавлен класс btn\n            onClick={addPeriod}\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n            disabled={submitting || status === 'submitted'}\n          >\n            <FaPlus /> Добавить часть отпуска\n          </motion.button>\n          \n          {/* Кнопка \"Сохранить черновик\" удалена */}\n          \n          {/* Кнопка \"Отправить\" теперь основная, тип submit */}\n          <motion.button\n            type=\"submit\" // Изменен тип на submit\n            className=\"submit-request btn btn-success\" // Оставляем классы\n            whileHover={{ scale: 1.05 }}\n            whileTap={{ scale: 0.95 }}\n            disabled={\n              submitting || \n              status === 'submitted' || \n              Object.keys(errors).length > 0 // Блокируем при ошибках валидации\n            } \n          >\n            <FaPaperPlane /> Отправить руководителю\n          </motion.button>\n        </div>\n      </form>\n      \n      {status === 'submitted' && (\n          <motion.div \n            className=\"success-message\" // Нужен CSS для этого класса\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: 1, y: 0 }}\n          >\n            Заявка успешно отправлена!\n          </motion.div>\n      )}\n    </motion.div>\n  );\n};\n\nexport default VacationForm;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO,CAAC,CAAC;AACpD,SAASC,MAAM,EAAEC,eAAe,QAAQ,eAAe;AACvD,OAAOC,UAAU,IAAIC,cAAc,QAAQ,kBAAkB;AAC7D,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SAASC,aAAa,EAAEC,MAAM,EAAEC,OAAO,EAAEC,MAAM,EAAEC,YAAY,QAAQ,gBAAgB;AACrF,OAAOC,EAAE,MAAM,oBAAoB;AACnC,SAASC,gBAAgB,EAAEC,qBAAqB,EAAEC,qBAAqB,QAAQ,qBAAqB,CAAC,CAAC;AACtG,OAAO,4CAA4C;AACnD,OAAO,oBAAoB;;AAE3B;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACAZ,cAAc,CAAC,IAAI,EAAEO,EAAE,CAAC;AAExB,MAAMM,YAAY,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACzB,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGrB,QAAQ,CAAC,IAAIsB,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAG,CAAC,CAAC;EAC9D,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGzB,QAAQ,CAAC,CAAC;IAAE0B,SAAS,EAAE,IAAI;IAAEC,OAAO,EAAE,IAAI;IAAEC,SAAS,EAAE;EAAE,CAAC,CAAC,CAAC;EAC1F,MAAM,CAACC,MAAM,EAAEC,SAAS,CAAC,GAAG9B,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC;EAC/C,MAAM,CAAC+B,KAAK,EAAEC,QAAQ,CAAC,GAAGhC,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACiC,QAAQ,EAAEC,WAAW,CAAC,GAAGlC,QAAQ,CAAC,CAAC,CAAC;EAC3C,MAAM,CAACmC,OAAO,EAAEC,UAAU,CAAC,GAAGpC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;EAC/C,MAAM,CAACqC,UAAU,EAAEC,aAAa,CAAC,GAAGtC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;EACrD,MAAM,CAACuC,MAAM,EAAEC,SAAS,CAAC,GAAGxC,QAAQ,CAAC,CAAC,CAAC,CAAC;EACxC,MAAM,CAACyC,SAAS,EAAEC,YAAY,CAAC,GAAG1C,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;;EAGlD;EACAC,SAAS,CAAC,MAAM;IACd,MAAM0C,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI;QACFP,UAAU,CAAC,IAAI,CAAC;QAChB,MAAMQ,SAAS,GAAG,MAAM/B,gBAAgB,CAACO,IAAI,CAAC,CAAC,CAAC;QAChDY,QAAQ,CAACY,SAAS,CAACC,UAAU,CAAC;QAC9BX,WAAW,CAACU,SAAS,CAACE,SAAS,CAAC;MAClC,CAAC,CAAC,OAAOC,KAAK,EAAE;QACd;QACA,IAAIA,KAAK,CAACC,OAAO,CAACC,QAAQ,CAAC,yBAAyB,CAAC,EAAE;UACnD3C,KAAK,CAAC4C,IAAI,CAAC,YAAY9B,IAAI,2DAA2DW,KAAK,SAAS,CAAC;UACrG;QACJ,CAAC,MAAM;UACHzB,KAAK,CAACyC,KAAK,CAAC,oCAAoC,CAAC,CAAC,CAAC;QACvD;QACA;QACAI,OAAO,CAACJ,KAAK,CAAC,6BAA6B,EAAEA,KAAK,CAAC,CAAC,CAAC;MACvD,CAAC,SAAS;QACRX,UAAU,CAAC,KAAK,CAAC;MACnB;IACF,CAAC;IAEDO,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,CAACvB,IAAI,CAAC,CAAC;;EAEV;EACA,MAAMgC,kBAAkB,GAAG5B,OAAO,CAAC6B,MAAM,CAAC,CAACC,GAAG,EAAEC,MAAM,KAAKD,GAAG,GAAGC,MAAM,CAAC3B,SAAS,EAAE,CAAC,CAAC;EACrF,MAAM4B,aAAa,GAAGzB,KAAK,GAAGE,QAAQ,GAAGmB,kBAAkB;;EAE3D;EACA,MAAMK,aAAa,GAAGA,CAAC/B,SAAS,EAAEC,OAAO,KAAK;IAC5C,IAAI,CAACD,SAAS,IAAI,CAACC,OAAO,IAAID,SAAS,GAAGC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC;IAC7D,MAAM+B,QAAQ,GAAGC,IAAI,CAACC,GAAG,CAACjC,OAAO,CAACkC,OAAO,CAAC,CAAC,GAAGnC,SAAS,CAACmC,OAAO,CAAC,CAAC,CAAC;IAClE,OAAOF,IAAI,CAACG,IAAI,CAACJ,QAAQ,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,CAAC;EACxD,CAAC;;EAED;EACA,MAAMK,gBAAgB,GAAIC,CAAC,IAAK;IAC9B3C,OAAO,CAAC4C,QAAQ,CAACD,CAAC,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC;IACjC;IACA1C,UAAU,CAAC,CAAC;MAAEC,SAAS,EAAE,IAAI;MAAEC,OAAO,EAAE,IAAI;MAAEC,SAAS,EAAE;IAAE,CAAC,CAAC,CAAC;IAC9DY,SAAS,CAAC,CAAC,CAAC,CAAC;IACbE,YAAY,CAAC,IAAI,CAAC;IAClBZ,SAAS,CAAC,OAAO,CAAC;EACpB,CAAC;;EAED;EACA,MAAMsC,gBAAgB,GAAGA,CAACC,KAAK,EAAEC,KAAK,EAAEC,IAAI,KAAK;IAC/C,MAAMC,UAAU,GAAG,CAAC,GAAGhD,OAAO,CAAC;IAC/BgD,UAAU,CAACH,KAAK,CAAC,CAACC,KAAK,CAAC,GAAGC,IAAI;;IAE/B;IACA,IAAIC,UAAU,CAACH,KAAK,CAAC,CAAC3C,SAAS,IAAI8C,UAAU,CAACH,KAAK,CAAC,CAAC1C,OAAO,IAAI6C,UAAU,CAACH,KAAK,CAAC,CAAC3C,SAAS,IAAI8C,UAAU,CAACH,KAAK,CAAC,CAAC1C,OAAO,EAAE;MACxH6C,UAAU,CAACH,KAAK,CAAC,CAACzC,SAAS,GAAG6B,aAAa,CACzCe,UAAU,CAACH,KAAK,CAAC,CAAC3C,SAAS,EAC3B8C,UAAU,CAACH,KAAK,CAAC,CAAC1C,OACpB,CAAC;IACH,CAAC,MAAM;MACL6C,UAAU,CAACH,KAAK,CAAC,CAACzC,SAAS,GAAG,CAAC,CAAC,CAAC;IACnC;IAEAH,UAAU,CAAC+C,UAAU,CAAC;IACtBC,YAAY,CAACD,UAAU,CAAC,CAAC,CAAC;EAC5B,CAAC;;EAED;EACA,MAAME,SAAS,GAAGA,CAAA,KAAM;IACtBjD,UAAU,CAAC,CAAC,GAAGD,OAAO,EAAE;MAAEE,SAAS,EAAE,IAAI;MAAEC,OAAO,EAAE,IAAI;MAAEC,SAAS,EAAE;IAAE,CAAC,CAAC,CAAC;EAC5E,CAAC;;EAED;EACA,MAAM+C,YAAY,GAAIN,KAAK,IAAK;IAC9B,MAAMG,UAAU,GAAGhD,OAAO,CAACoD,MAAM,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,KAAKT,KAAK,CAAC;IACxD5C,UAAU,CAAC+C,UAAU,CAAC;IACtBC,YAAY,CAACD,UAAU,CAAC,CAAC,CAAC;EAC5B,CAAC;;EAED;EACA;EACA,MAAMC,YAAY,GAAGA,CAACM,iBAAiB,GAAGvD,OAAO,KAAK;IAAE;IACtD;IACA,MAAMwD,aAAa,GAAG,CAAC,CAAC;IACxB;;IAEA;IACA,IAAID,iBAAiB,CAACE,MAAM,KAAK,CAAC,EAAE;MAClCD,aAAa,CAACE,SAAS,GAAG,kDAAkD;MAC5E;MACA1C,SAAS,CAACwC,aAAa,CAAC;MACxB,OAAO,KAAK;IACd;IAEA,MAAMG,eAAe,GAAGJ,iBAAiB,CAACK,IAAI,CAC5C7B,MAAM,IAAI,CAACA,MAAM,CAAC7B,SAAS,IAAI,CAAC6B,MAAM,CAAC5B,OAAO,IAAI4B,MAAM,CAAC7B,SAAS,GAAG6B,MAAM,CAAC5B,OAC9E,CAAC;IACD,IAAIwD,eAAe,EAAE;MACnBH,aAAa,CAACK,YAAY,GAAG,2EAA2E;MACxG;IACF;;IAEA;IACA,IAAI,CAACF,eAAe,EAAE;MACpB,MAAMG,cAAc,GAAGP,iBAAiB,CAAC1B,MAAM,CAAC,CAACC,GAAG,EAAEC,MAAM,KAAKD,GAAG,GAAGC,MAAM,CAAC3B,SAAS,EAAE,CAAC,CAAC;MAE3F,IAAI0D,cAAc,IAAI,CAAC,EAAE;QACpBN,aAAa,CAACO,MAAM,GAAG,kEAAkE;MAC9F,CAAC,MAAM;QAAE;QACL;QACApC,OAAO,CAACqC,GAAG,CAAC,kCAAkC,EAAEC,IAAI,CAACC,SAAS,CAACX,iBAAiB,CAACY,GAAG,CAACC,CAAC,KAAK;UAAEC,KAAK,EAAED,CAAC,CAAClE,SAAS;UAAEoE,GAAG,EAAEF,CAAC,CAACjE,OAAO;UAAEoE,IAAI,EAAEH,CAAC,CAAChE;QAAU,CAAC,CAAC,CAAC,CAAC,CAAC;;QAExJ;QACA,MAAMoE,aAAa,GAAGjB,iBAAiB,CAACK,IAAI,CAAC7B,MAAM,IAAIA,MAAM,CAAC3B,SAAS,IAAI,EAAE,CAAC;QAC9EuB,OAAO,CAACqC,GAAG,CAAC,+BAA+B,EAAEQ,aAAa,CAAC,CAAC,CAAC;QAC7D;QACA,IAAI,CAACA,aAAa,EAAE;UAChBhB,aAAa,CAACiB,UAAU,GAAG,kEAAkE;QACjG;QACA;QACA,IAAIX,cAAc,GAAIvD,KAAK,GAAGE,QAAS,EAAE;UACrC+C,aAAa,CAACjD,KAAK,GAAG,0CAA0CA,KAAK,GAAGE,QAAQ,QAAQ;QAC5F;MACJ;IACF;;IAEA;IACAkB,OAAO,CAACqC,GAAG,CAAC,2BAA2B,EAAEC,IAAI,CAACC,SAAS,CAACV,aAAa,CAAC,CAAC;;IAEvE;IACAxC,SAAS,CAAC;MAAE,GAAGwC;IAAc,CAAC,CAAC;;IAE/B;IACA;;IAEA,MAAMkB,OAAO,GAAGC,MAAM,CAACC,IAAI,CAACpB,aAAa,CAAC,CAACC,MAAM,KAAK,CAAC;IACvD9B,OAAO,CAACqC,GAAG,CAAC,2BAA2BU,OAAO,EAAE,CAAC,CAAC,CAAC;IACnD,OAAOA,OAAO,CAAC,CAAC;EAClB,CAAC;;EAED;;EAEA;EACA,MAAMG,YAAY,GAAG,MAAOrC,CAAC,IAAK;IAChC;IACA,IAAIA,CAAC,IAAI,OAAOA,CAAC,CAACsC,cAAc,KAAK,UAAU,EAAE;MAC7CtC,CAAC,CAACsC,cAAc,CAAC,CAAC;IACtB;;IAEA;IACA,IAAI,CAAC7B,YAAY,CAAC,CAAC,EAAE;MACjBtB,OAAO,CAACqC,GAAG,CAAC,yCAAyC,CAAC;MACtDlF,KAAK,CAACiG,IAAI,CAAC,sDAAsD,CAAC;MAClE;IACJ;IAEApD,OAAO,CAACqC,GAAG,CAAC,gDAAgD,CAAC;IAC7DlD,aAAa,CAAC,IAAI,CAAC;IACnB,IAAI;MACF,IAAIkE,gBAAgB,GAAG/D,SAAS;;MAEhC;MACA;MACA;MACA,MAAMgE,eAAe,GAAG;QACtBrF,IAAI;QACJI,OAAO,EAAEA,OAAO,CAACmE,GAAG,CAACpC,MAAM,KAAK;UAC9B;UACA;UACAmD,UAAU,EAAEnD,MAAM,CAAC7B,SAAS,CAACiF,WAAW,CAAC,CAAC;UAC1CC,QAAQ,EAAErD,MAAM,CAAC5B,OAAO,CAACgF,WAAW,CAAC,CAAC;UACtCE,UAAU,EAAEtD,MAAM,CAAC3B;QACrB,CAAC,CAAC,CAAC;QACHkF,QAAQ,EAAE,CAAC,CAAC;MACd,CAAC;;MAED;MACA;MACA,MAAMC,cAAc,GAAG,MAAMjG,qBAAqB,CAAC2F,eAAe,CAAC;MACnED,gBAAgB,GAAGO,cAAc,CAACC,EAAE,CAAC,CAAC;MACtCtE,YAAY,CAAC8D,gBAAgB,CAAC,CAAC,CAAC;MAChClG,KAAK,CAAC4C,IAAI,CAAC,6BAA6B,CAAC,CAAC,CAAC;;MAE3C;MACA,MAAMnC,qBAAqB,CAACyF,gBAAgB,CAAC;MAC7ClG,KAAK,CAAC2G,OAAO,CAAC,wCAAwC,CAAC;MACvDnF,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;IAE1B,CAAC,CAAC,OAAOiB,KAAK,EAAE;MACdzC,KAAK,CAACyC,KAAK,CAACA,KAAK,CAACC,OAAO,IAAI,2CAA2C,CAAC;MACzE;MACA;MACA;IACF,CAAC,SAAS;MACR;MACAV,aAAa,CAAC,KAAK,CAAC;IACtB;EACF,CAAC;EAED,oBACErB,OAAA,CAACf,MAAM,CAACgH,GAAG;IACTC,SAAS,EAAC,yBAAyB;IACnCC,OAAO,EAAE;MAAEC,OAAO,EAAE;IAAE,CAAE;IACxBC,OAAO,EAAE;MAAED,OAAO,EAAE;IAAE,CAAE;IACxBE,UAAU,EAAE;MAAEC,QAAQ,EAAE;IAAI,CAAE;IAAAC,QAAA,gBAE9BxG,OAAA;MAAAwG,QAAA,GAAI,uHAAsB,EAACrG,IAAI,EAAC,qBAAI;IAAA;MAAAsG,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAEzC5G,OAAA;MAAKkG,SAAS,EAAC,eAAe;MAAAM,QAAA,gBAC5BxG,OAAA;QAAO6G,OAAO,EAAC,MAAM;QAAAL,QAAA,EAAC;MAAa;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC,eAC3C5G,OAAA;QAAQ+F,EAAE,EAAC,MAAM;QAAC7C,KAAK,EAAE/C,IAAK;QAAC2G,QAAQ,EAAEhE,gBAAiB;QAACiE,QAAQ,EAAE7F,OAAO,IAAIE,UAAW;QAAAoF,QAAA,gBACzFxG,OAAA;UAAQkD,KAAK,EAAE,IAAI7C,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAE;UAAAkG,QAAA,EAAC;QAAW;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC,eAC7D5G,OAAA;UAAQkD,KAAK,EAAE,IAAI7C,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAG,CAAE;UAAAkG,QAAA,EAAC;QAAa;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAQ,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC7D,CAAC,EACR1F,OAAO,iBAAIlB,OAAA;QAAMkG,SAAS,EAAC,mBAAmB;QAAAM,QAAA,EAAC;MAAmB;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACvE,CAAC,eAEN5G,OAAA,CAACf,MAAM,CAACgH,GAAG;MACTC,SAAS,EAAC,sBAAsB,CAAC;MAAA;MACjCC,OAAO,EAAE;QAAEa,CAAC,EAAE,CAAC,EAAE;QAAEZ,OAAO,EAAE;MAAE,CAAE;MAChCC,OAAO,EAAE;QAAEW,CAAC,EAAE,CAAC;QAAEZ,OAAO,EAAE;MAAE,CAAE;MAC9BE,UAAU,EAAE;QAAEW,KAAK,EAAE;MAAI,CAAE;MAAAT,QAAA,gBAE3BxG,OAAA;QAAKkG,SAAS,EAAC,YAAY;QAAAM,QAAA,gBACzBxG,OAAA;UAAAwG,QAAA,EAAM;QAAc;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eAC3B5G,OAAA;UAAMkG,SAAS,EAAC,aAAa;UAAAM,QAAA,EAAE1F;QAAK;UAAA2F,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACzC,CAAC,eACN5G,OAAA;QAAKkG,SAAS,EAAC,YAAY;QAAAM,QAAA,gBACzBxG,OAAA;UAAAwG,QAAA,EAAM;QAAa;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eAC1B5G,OAAA;UAAMkG,SAAS,EAAC,aAAa;UAAAM,QAAA,EAAExF;QAAQ;UAAAyF,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5C,CAAC,eACN5G,OAAA;QAAKkG,SAAS,EAAC,YAAY;QAAAM,QAAA,gBACzBxG,OAAA;UAAAwG,QAAA,EAAM;QAAU;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACvB5G,OAAA;UAAMkG,SAAS,EAAC,aAAa;UAAAM,QAAA,EAAErE;QAAkB;UAAAsE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAO,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACtD,CAAC,eACN5G,OAAA;QAAKkG,SAAS,EAAC,YAAY;QAAAM,QAAA,gBACzBxG,OAAA;UAAAwG,QAAA,EAAM;QAAS;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACtB5G,OAAA;UAAMkG,SAAS,EAAE,eAAe3D,aAAa,GAAG,CAAC,GAAG,OAAO,GAAG,EAAE,EAAG;UAAAiE,QAAA,EAChEjE;QAAa;UAAAkE,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACV,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACI,CAAC,EAGZtF,MAAM,CAAC8C,YAAY,iBAAIpE,OAAA;MAAKkG,SAAS,EAAC,eAAe;MAAAM,QAAA,EAAElF,MAAM,CAAC8C;IAAY;MAAAqC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,EACjFtF,MAAM,CAAC2C,SAAS,iBAAIjE,OAAA;MAAKkG,SAAS,EAAC,eAAe;MAAAM,QAAA,EAAElF,MAAM,CAAC2C;IAAS;MAAAwC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,EAC3EtF,MAAM,CAACgD,MAAM,iBAAItE,OAAA;MAAKkG,SAAS,EAAC,eAAe;MAAAM,QAAA,EAAElF,MAAM,CAACgD;IAAM;MAAAmC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,EAGrEtF,MAAM,CAAC0D,UAAU,gBAAGhF,OAAA;MAAKkG,SAAS,EAAC,eAAe;MAAAM,QAAA,EAAElF,MAAM,CAAC0D;IAAU;MAAAyB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,GAAG,IAAI,EACnFtF,MAAM,CAACR,KAAK,iBAAId,OAAA;MAAKkG,SAAS,EAAC,eAAe;MAAAM,QAAA,EAAElF,MAAM,CAACR;IAAK;MAAA2F,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAM,CAAC,eAGpE5G,OAAA;MAAMkH,QAAQ,EAAE9B,YAAa;MAAAoB,QAAA,GACF,GAAC,EACvBjG,OAAO,CAACmE,GAAG,CAAC,CAACpC,MAAM,EAAEc,KAAK,kBACzBpD,OAAA,CAACf,MAAM,CAACgH,GAAG;QAETC,SAAS,EAAC,sBAAsB,CAAC;QAAA;QACjCC,OAAO,EAAE;UAAEC,OAAO,EAAE,CAAC;UAAEe,CAAC,EAAE;QAAG,CAAE;QAC/Bd,OAAO,EAAE;UAAED,OAAO,EAAE,CAAC;UAAEe,CAAC,EAAE;QAAE,CAAE;QAC9BC,IAAI,EAAE;UAAEhB,OAAO,EAAE,CAAC;UAAEe,CAAC,EAAE,CAAC;QAAG,CAAE;QAC7Bb,UAAU,EAAE;UAAEW,KAAK,EAAE7D,KAAK,GAAG;QAAI,CAAE;QAAAoD,QAAA,gBAEnCxG,OAAA;UAAAwG,QAAA,GAAI,4EAAc,EAACpD,KAAK,GAAG,CAAC;QAAA;UAAAqD,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAK,CAAC,eAElC5G,OAAA;UAAKkG,SAAS,EAAC,aAAa;UAAAM,QAAA,gBAC1BxG,OAAA;YAAKkG,SAAS,EAAC,YAAY;YAAAM,QAAA,gBACzBxG,OAAA;cAAO6G,OAAO,EAAE,cAAczD,KAAK,EAAG;cAAAoD,QAAA,EAAC;YAAW;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAC1D5G,OAAA;cAAKkG,SAAS,EAAC,uBAAuB;cAAAM,QAAA,gBACpCxG,OAAA,CAACb,UAAU;gBACT4G,EAAE,EAAE,cAAc3C,KAAK,EAAG;gBAC1BiE,QAAQ,EAAE/E,MAAM,CAAC7B,SAAU;gBAC3BqG,QAAQ,EAAGxD,IAAI,IAAKH,gBAAgB,CAACC,KAAK,EAAE,WAAW,EAAEE,IAAI,CAAE;gBAC/DgE,YAAY;gBACZ7G,SAAS,EAAE6B,MAAM,CAAC7B,SAAU;gBAC5BC,OAAO,EAAE4B,MAAM,CAAC5B,OAAQ;gBACxB6G,OAAO,EAAE,IAAIlH,IAAI,CAACF,IAAI,EAAE,CAAC,EAAE,CAAC,CAAE;gBAC9BqH,OAAO,EAAE,IAAInH,IAAI,CAACF,IAAI,EAAE,EAAE,EAAE,EAAE,CAAE;gBAChCsH,UAAU,EAAC,YAAY;gBACvBC,MAAM,EAAC,IAAI;gBACXC,eAAe,EAAC,2EAAe;gBAC/BzB,SAAS,EAAC,YAAY;gBACtBa,QAAQ,EAAE3F,UAAU,IAAIR,MAAM,KAAK;cAAY;gBAAA6F,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChD,CAAC,eACF5G,OAAA,CAACV,aAAa;gBAAC4G,SAAS,EAAC;cAAW;gBAAAO,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACpC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAEN5G,OAAA;YAAKkG,SAAS,EAAC,YAAY;YAAAM,QAAA,gBACzBxG,OAAA;cAAO6G,OAAO,EAAE,YAAYzD,KAAK,EAAG;cAAAoD,QAAA,EAAC;YAAc;cAAAC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAC3D5G,OAAA;cAAKkG,SAAS,EAAC,uBAAuB;cAAAM,QAAA,gBACpCxG,OAAA,CAACb,UAAU;gBACT4G,EAAE,EAAE,YAAY3C,KAAK,EAAG;gBACxBiE,QAAQ,EAAE/E,MAAM,CAAC5B,OAAQ;gBACzBoG,QAAQ,EAAGxD,IAAI,IAAKH,gBAAgB,CAACC,KAAK,EAAE,SAAS,EAAEE,IAAI,CAAE;gBAC7DsE,UAAU;gBACVnH,SAAS,EAAE6B,MAAM,CAAC7B,SAAU;gBAC5BC,OAAO,EAAE4B,MAAM,CAAC5B,OAAQ;gBACxB6G,OAAO,EAAEjF,MAAM,CAAC7B,SAAS,IAAI,IAAIJ,IAAI,CAACF,IAAI,EAAE,CAAC,EAAE,CAAC,CAAE;gBAClDqH,OAAO,EAAE,IAAInH,IAAI,CAACF,IAAI,EAAE,EAAE,EAAE,EAAE,CAAE;gBAChCsH,UAAU,EAAC,YAAY;gBACvBC,MAAM,EAAC,IAAI;gBACXC,eAAe,EAAC,2EAAe;gBAC/BzB,SAAS,EAAC,YAAY;gBACtBa,QAAQ,EAAE3F,UAAU,IAAIR,MAAM,KAAK,WAAW,IAAI,CAAC0B,MAAM,CAAC7B,SAAU,CAAC;cAAA;gBAAAgG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACtE,CAAC,eACF5G,OAAA,CAACV,aAAa;gBAAC4G,SAAS,EAAC;cAAW;gBAAAO,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACpC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACH,CAAC,eAEN5G,OAAA;UAAKkG,SAAS,EAAC,YAAY;UAAAM,QAAA,GAAC,yFACT,eAAAxG,OAAA;YAAAwG,QAAA,EAASlE,MAAM,CAAC3B;UAAS;YAAA8F,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAS,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACjD,CAAC,EAELrG,OAAO,CAACyD,MAAM,GAAG,CAAC,iBACjBhE,OAAA,CAACf,MAAM,CAAC4I,MAAM;UACZC,IAAI,EAAC,QAAQ;UACb5B,SAAS,EAAC,8BAA8B,CAAC;UAAA;UACzC6B,OAAO,EAAEA,CAAA,KAAMrE,YAAY,CAACN,KAAK,CAAE;UACnC4E,UAAU,EAAE;YAAEC,KAAK,EAAE;UAAK,CAAE;UAC5BC,QAAQ,EAAE;YAAED,KAAK,EAAE;UAAK,CAAE;UAC1BlB,QAAQ,EAAE3F,UAAU,IAAIR,MAAM,KAAK,WAAY;UAAA4F,QAAA,gBAE/CxG,OAAA,CAACR,OAAO;YAAAiH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,8EACb;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAe,CAChB;MAAA,GAtEIxD,KAAK;QAAAqD,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAuEA,CACb,CAAC,EACsB,GAAC,eAE3B5G,OAAA;QAAKkG,SAAS,EAAC,cAAc;QAAAM,QAAA,gBAC3BxG,OAAA,CAACf,MAAM,CAAC4I,MAAM;UACZC,IAAI,EAAC,QAAQ;UACb5B,SAAS,EAAC,gBAAgB,CAAC;UAAA;UAC3B6B,OAAO,EAAEtE,SAAU;UACnBuE,UAAU,EAAE;YAAEC,KAAK,EAAE;UAAK,CAAE;UAC5BC,QAAQ,EAAE;YAAED,KAAK,EAAE;UAAK,CAAE;UAC1BlB,QAAQ,EAAE3F,UAAU,IAAIR,MAAM,KAAK,WAAY;UAAA4F,QAAA,gBAE/CxG,OAAA,CAACT,MAAM;YAAAkH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,+HACZ;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAe,CAAC,eAKhB5G,OAAA,CAACf,MAAM,CAAC4I,MAAM;UACZC,IAAI,EAAC,QAAQ,CAAC;UAAA;UACd5B,SAAS,EAAC,gCAAgC,CAAC;UAAA;UAC3C8B,UAAU,EAAE;YAAEC,KAAK,EAAE;UAAK,CAAE;UAC5BC,QAAQ,EAAE;YAAED,KAAK,EAAE;UAAK,CAAE;UAC1BlB,QAAQ,EACN3F,UAAU,IACVR,MAAM,KAAK,WAAW,IACtBsE,MAAM,CAACC,IAAI,CAAC7D,MAAM,CAAC,CAAC0C,MAAM,GAAG,CAAC,CAAC;UAChC;UAAAwC,QAAA,gBAEDxG,OAAA,CAACN,YAAY;YAAA+G,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAE,CAAC,oIAClB;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAe,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACb,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACF,CAAC,EAENhG,MAAM,KAAK,WAAW,iBACnBZ,OAAA,CAACf,MAAM,CAACgH,GAAG;MACTC,SAAS,EAAC,iBAAiB,CAAC;MAAA;MAC5BC,OAAO,EAAE;QAAEC,OAAO,EAAE,CAAC;QAAEe,CAAC,EAAE;MAAG,CAAE;MAC/Bd,OAAO,EAAE;QAAED,OAAO,EAAE,CAAC;QAAEe,CAAC,EAAE;MAAE,CAAE;MAAAX,QAAA,EAC/B;IAED;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAY,CACf;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACS,CAAC;AAEjB,CAAC;AAAC1G,EAAA,CAjYID,YAAY;AAAAkI,EAAA,GAAZlI,YAAY;AAmYlB,eAAeA,YAAY;AAAC,IAAAkI,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}